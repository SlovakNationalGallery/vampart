class ImagesController < ApplicationController
  def new
    @image = Image.new
  end

  def create
    @factory = ImageFactory.new(image_params)

    if @factory.save
      redirect_to @factory.image
    else
      message = @factory.error_message

      @factory.image.destroy

      flash[:notice] = message
      redirect_to new_image_url
    end
  end

  def show
    @image = Image.find(params[:id])
  end

  private

  def image_params
    params.require(:image).permit(:photo)
  end
end

class LandingPageImage
  def self.created_at
    Time.now
  end

  def self.processed_photo_url
    '/landing-page-image.jpeg'
  end

  def self.similar_faces
    @similar_faces ||= SimilarFacesFinder.for(model)
  end

  def self.model
    [
      -0.041714355349541,
      0.027635304257274,
      0.15281756222248,
      -0.11439394950867,
      -0.003944109659642,
      0.029919221997261,
      -0.10554100573063,
      0.093988455832005,
      0.10718102008104,
      -0.042068112641573,
      0.088534533977509,
      -0.026974832639098,
      -0.045037928968668,
      -0.074236072599888,
      0.068960197269917,
      0.012913154438138,
      -0.11671386659145,
      0.0234768204391,
      -0.034873444586992,
      -0.072704836726189,
      0.15214821696281,
      0.17976014316082,
      -0.0026822306681424,
      -0.11183507740498,
      0.029329126700759,
      0.089682728052139,
      0.10333993285894,
      0.0044170767068863,
      0.06283550709486,
      -0.032677635550499,
      0.039545197039843,
      -0.12185600399971,
      0.13581037521362,
      0.074927613139153,
      0.11698588728905,
      -0.0083206109702587,
      0.11292280256748,
      0.051346458494663,
      0.11032117903233,
      -0.01470369566232,
      0.044599208980799,
      -0.033100541681051,
      0.019239351153374,
      0.068353116512299,
      -0.045953769236803,
      -0.12204334139824,
      -0.009127733297646,
      -0.065892025828362,
      -0.0072994288057089,
      0.0025122032966465,
      -0.055880203843117,
      0.083221241831779,
      -0.082987137138844,
      0.13379716873169,
      0.017869871109724,
      -0.0048480853438377,
      0.044063709676266,
      -0.15986248850822,
      -0.20469635725021,
      -0.09454720467329,
      -0.041578941047192,
      -0.2242257297039,
      0.03231505677104,
      0.094388715922832,
      0.0092111295089126,
      -0.06116134300828,
      -0.0051327808760107,
      0.04380476474762,
      0.11466594040394,
      0.10889729857445,
      0.016602199524641,
      -0.055383268743753,
      -0.041014909744263,
      -0.094226583838463,
      0.047099247574806,
      -0.080540753901005,
      -0.10297353565693,
      0.047148186713457,
      -0.022737475112081,
      0.021532772108912,
      0.0078935148194432,
      0.11697721481323,
      0.16578650474548,
      0.14081652462482,
      0.058300919830799,
      -0.042312785983086,
      0.09264025837183,
      0.15209482610226,
      0.076654255390167,
      0.078785926103592,
      0.046273566782475,
      -0.078266650438309,
      -0.1241342946887,
      0.081432983279228,
      -0.07273156195879,
      -0.10525024682283,
      -0.11004235595465,
      0.069550782442093,
      -0.06815580278635,
      -0.014934962615371,
      -0.0030884279403836,
      -0.0012956690043211,
      -0.027103878557682,
      -0.060077458620071,
      0.14089688658714,
      -0.0093073528259993,
      0.055931564420462,
      -0.032795626670122,
      0.083372451364994,
      -0.088200785219669,
      -0.062723830342293,
      -0.052385296672583,
      -0.14664627611637,
      0.088806390762329,
      0.13200730085373,
      -0.031783975660801,
      0.047705892473459,
      -0.11518837511539,
      0.0095766065642238,
      -0.0049713393673301,
      0.15421994030476,
      0.076631046831608,
      0.071671031415462,
      0.011332586407661,
      0.11285597831011,
      -0.066938295960426,
      0.26984816789627,
      0.14642050862312
    ]
  end
end
